<div id="editModal" class="fixed inset-0 z-50 hidden">
  <!-- Overlay animado -->
  <div
    class="fixed inset-0 bg-black/70 backdrop-blur-md transition-all duration-300"
  ></div>

  <!-- Contenedor centrado -->
  <div class="fixed inset-0 z-50 flex items-center justify-center p-4">
    <!-- Modal Card -->
    <div
      class="bg-gradient-to-br from-white via-rose-50/30 to-white rounded-3xl shadow-[0_20px_50px_rgba(232,180,184,0.4)] w-full max-w-lg transform transition-all duration-300 scale-100"
    >
      <!-- Header con gradiente -->
      <div class="relative overflow-hidden p-6 rounded-t-3xl">
        <div
          class="absolute inset-0 bg-gradient-to-r from-pink-500 to-fuchsia-500 opacity-90"
        ></div>
        <div class="relative flex items-center justify-between">
          <h3 class="text-xl font-light text-white flex items-center">
            <i class="fas fa-user-edit mr-3"></i>
            Editar Perfil
          </h3>
          <button
            onclick="closeModal()"
            class="text-white/80 hover:text-white transition-colors hover:rotate-90 duration-300"
          >
            <i class="fas fa-times text-xl"></i>
          </button>
        </div>
      </div>

      <!-- Formulario compacto -->
      <form id="modalForm" class="p-6 space-y-5">
        <!-- Campo Nombre -->
        <div class="group">
          <label
            class="block text-sm font-semibold text-gray-700 mb-2 flex items-center"
          >
            <i class="fas fa-user text-rose-400 mr-2"></i>
            Nombre
          </label>
          <input
            type="text"
            id="modalNombre"
            value="{{ current_user.nombre }}"
            class="w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-rose-400 focus:border-transparent transition-all text-gray-800"
          />
        </div>

        <!-- Campo Apellido -->
        <div class="group">
          <label
            class="block text-sm font-semibold text-gray-700 mb-2 flex items-center"
          >
            <i class="fas fa-user text-rose-400 mr-2"></i>
            Apellido
          </label>
          <input
            type="text"
            id="modalApellido"
            value="{{ current_user.apellido }}"
            class="w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-rose-400 focus:border-transparent transition-all text-gray-800"
          />
        </div>

        <!-- Campo Teléfono -->
        <div class="group">
          <label
            class="block text-sm font-semibold text-gray-700 mb-2 flex items-center"
          >
            <i class="fas fa-phone text-rose-400 mr-2"></i>
            Teléfono
          </label>
          <input
            type="tel"
            id="modalTelefono"
            value="{{ current_user.numero }}"
            class="w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-rose-400 focus:border-transparent transition-all text-gray-800"
          />
        </div>

        <!-- Campo Contraseña con toggle -->
        <div class="group">
          <label
            class="block text-sm font-semibold text-gray-700 mb-2 flex items-center"
          >
            <i class="fas fa-lock text-rose-400 mr-2"></i>
            Contraseña
          </label>
          <div class="relative">
            <input
              type="password"
              id="modalPassword"
              value=""
              class="w-full px-4 py-2.5 pr-12 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-rose-400 focus:border-transparent transition-all text-gray-800"
            />
            <button
              type="button"
              onclick="toggleModalPassword()"
              class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-rose-500 focus:outline-none"
            >
              <i id="passwordIcon" class="fas fa-eye text-sm"></i>
            </button>
          </div>
        </div>

        <!-- Botones de acción -->
        <div class="flex gap-3 pt-2">
          <button
            type="button"
            onclick="saveModal()"
            class="flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white py-2.5 rounded-xl font-semibold hover:shadow-lg hover:shadow-green-500/25 transform hover:scale-[1.02] transition-all duration-300"
          >
            <i class="fas fa-check mr-2"></i>
            Guardar
          </button>
          <button
            type="button"
            onclick="closeModal()"
            class="flex-1 bg-gray-100 text-gray-700 py-2.5 rounded-xl font-semibold hover:bg-gray-200 hover:shadow-md transform hover:scale-[1.02] transition-all duration-300"
          >
            <i class="fas fa-times mr-2"></i>
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- JavaScript optimizado -->
<script>
  // Funciones mejoradas del Modal
  function openModal() {
    const modal = document.getElementById("editModal");
    modal.classList.remove("hidden");
    document.body.style.overflow = "hidden";

    // Animación suave
    setTimeout(() => {
      modal.querySelector("> div > div").classList.add("scale-100");
    }, 10);
  }

  function closeModal() {
    const modal = document.getElementById("editModal");
    modal.classList.add("hidden");
    document.body.style.overflow = "auto";
  }

  function toggleModalPassword() {
    const input = document.getElementById("modalPassword");
    const icon = document.getElementById("passwordIcon");
    const isPassword = input.type === "password";

    input.type = isPassword ? "text" : "password";
    icon.className = isPassword
      ? "fas fa-eye-slash text-sm"
      : "fas fa-eye text-sm";
  }

  function saveModal() {
    // Actualizar display
    ["Nombre", "Apellido", "Telefono", "Email"].forEach((field) => {
      const value = document.getElementById("modal" + field).value;
      document.getElementById("display" + field).textContent = value;
    });

    closeModal();

    // Notificación elegante
    const notification = document.createElement("div");
    notification.className =
      "fixed top-4 right-4 bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-3 rounded-xl shadow-lg z-50";
    notification.innerHTML =
      '<i class="fas fa-check mr-2"></i>¡Perfil actualizado!';
    document.body.appendChild(notification);

    setTimeout(() => notification.remove(), 3000);
  }

  // Event listeners mejorados
  document.getElementById("editModal").addEventListener("click", (e) => {
    if (e.target === e.currentTarget) closeModal();
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") closeModal();
  });
</script>